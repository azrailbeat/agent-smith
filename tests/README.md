# Тестовая документация для системы Agent Smith

## Обзор

Данный документ содержит информацию о тестовых процедурах системы Agent Smith - передовой платформы государственного управления, объединяющей ИИ, блокчейн-технологии и современные подходы к управлению государственными услугами.

## Структура тестирования

Тестирование системы Agent Smith разделено на несколько уровней:

1. **Базовое API-тестирование** (`test-api.js`)
   - Проверка доступности всех ключевых API-эндпоинтов
   - Валидация форматов ответов и кодов состояния
   - Быстрая проверка работоспособности системы

2. **Интеграционное тестирование** (`test-integration.js`)
   - Проверка взаимодействия между различными компонентами системы
   - Тестирование полных рабочих процессов (workflow)
   - Валидация корректной передачи данных между модулями

3. **Комплексное функциональное тестирование** (`comprehensive-tests.js`)
   - Всесторонняя проверка всех модулей системы
   - Имитация реальных пользовательских сценариев
   - Валидация бизнес-логики и функциональных возможностей

## Тестируемые модули

### 1. Модуль обращений граждан
- Создание, получение, обновление и удаление обращений
- Автоматическая обработка обращений ИИ-агентами
- Назначение обращений сотрудникам
- Смена статусов и закрытие обращений

### 2. Модуль ИИ-агентов
- Получение списка доступных агентов
- Получение информации о конкретном агенте
- Обработка обращений разными типами агентов
- Получение и анализ результатов работы агентов

### 3. Модуль блокчейн
- Получение списка записей в блокчейне
- Создание новых блокчейн-записей
- Связывание блокчейн-записей с сущностями системы
- Проверка целостности и неизменности данных

### 4. Модуль организационной структуры
- Управление отделами и подразделениями
- Управление пользователями и ролями
- Назначение сотрудников в отделы
- Распределение задач по организационной структуре

### 5. Модуль активностей и журналирования
- Регистрация системных событий
- Отслеживание пользовательских действий
- Связывание активностей с сущностями системы
- Хронология изменений и аудит действий

## Запуск тестов

### API-тесты

```bash
node test-api.js
```

Эти тесты проверяют доступность базовых API-эндпоинтов и корректность форматов ответов.

### Интеграционные тесты

```bash
node test-integration.js
```

Эти тесты проверяют взаимодействие между различными компонентами системы, симулируя реальные рабочие процессы.

### Комплексные тесты

```bash
node comprehensive-tests.js
```

Эти тесты выполняют всестороннюю проверку всех модулей системы и их взаимодействия.

## Подготовка тестовой среды

Перед запуском тестов убедитесь, что:

1. Сервер Agent Smith запущен на `http://localhost:5000`
2. База данных инициализирована
3. В системе настроены базовые ИИ-агенты
4. Добавлены минимум один отдел и один пользователь
5. Установлен OPENAI_API_KEY или ANTHROPIC_API_KEY (для тестов с ИИ-агентами)

## Интерпретация результатов

Тесты используют цветовое кодирование для вывода результатов:

- **Зеленый** (✓): Тест пройден успешно
- **Красный** (✗): Тест не пройден, требуется исправление
- **Желтый**: Предупреждение или пропущенный тест
- **Синий**: Информационные сообщения

В конце каждого набора тестов выводится сводная статистика в формате "X/Y тестов пройдено".

## Рекомендации по тестированию

- **Регулярность**: Запускайте тесты после любых существенных изменений в системе
- **Изоляция**: Тестируйте на изолированной базе данных, где это возможно
- **Полнота**: Периодически запускайте полный набор тестов, а не только API-тесты
- **Мониторинг**: Отслеживайте изменения в результатах тестов с течением времени

## Добавление новых тестов

При расширении функциональности системы рекомендуется добавлять новые тесты:

1. Для новых API-эндпоинтов добавляйте соответствующие проверки в `test-api.js`
2. Для новых рабочих процессов добавляйте новые сценарии в `test-integration.js`
3. Для новых модулей создавайте отдельные наборы тестов в `comprehensive-tests.js`

## Известные ограничения

- Некоторые эндпоинты могут возвращать HTML вместо JSON, что затрудняет автоматическое тестирование
- Тесты блокчейн-функциональности могут требовать специальных ключей для Moralis API
- Тесты ИИ-агентов требуют наличия действующих API-ключей для OpenAI или Anthropic
- Удаление некоторых сущностей может быть невозможно из-за ссылочной целостности

## Рекомендации по улучшению системы тестирования

1. **Разработка через тестирование (TDD)**: Внедрить практику написания тестов до реализации функциональности
2. **Автоматизация**: Настроить автоматический запуск тестов при коммитах в репозиторий
3. **Расширение покрытия**: Добавить тесты для граничных случаев и обработки ошибок
4. **Нагрузочное тестирование**: Разработать тесты для проверки производительности при высокой нагрузке
5. **UI-тестирование**: Добавить автоматизированные тесты пользовательского интерфейса